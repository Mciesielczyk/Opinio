<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Witaj adminie</title>
           <link rel="stylesheet" type="text/css" href="public/styles/Questions.css">

    <link rel="stylesheet" type="text/css" href="public/styles/Discover.css">
        <link rel="stylesheet" type="text/css" href="public/styles/Admin.css">
                <link rel="stylesheet" type="text/css" href="public/styles/header.css">


</head>

    <?php include 'header.php'; ?>

<div class="edit-survey-container">
    <a href="/adminPanel" class="back-link">← Powrót do panelu</a>
    <h1>Edycja ankiety: <?= htmlspecialchars($survey['title']) ?></h1>

    <section class="add-question-section">
        <h3>Dodaj nowe pytanie</h3>
        <form action="/addQuestion" method="POST" class="admin-form">
            <input type="hidden" name="survey_id" value="<?= $survey['id'] ?>">
            
            <div class="input-group">
                <label>Treść pytania:</label>
                <textarea name="question_text" rows="3" required placeholder="Wpisz treść pytania..."></textarea>
            </div>

            <div class="scores-grid">
                <div class="score-input">
                    <label>Lewa - Prawa (-5 do 5)</label>
                    <input type="number" name="lp" min="-5" max="5" value="0">
                </div>
                <div class="score-input">
                    <label>Władza - Wolność</label>
                    <input type="number" name="ww" min="-5" max="5" value="0">
                </div>
                <div class="score-input">
                    <label>Postęp - Konserwa</label>
                    <input type="number" name="pk" min="-5" max="5" value="0">
                </div>
                <div class="score-input">
                    <label>Globalizm - Nacjonalizm</label>
                    <input type="number" name="gn" min="-5" max="5" value="0">
                </div>
            </div>
            <button type="submit" class="btn-add">Dodaj pytanie do ankiety</button>
        </form>
    </section>

    <hr>

<section class="existing-questions">
    <h3>Lista pytań w tej ankiecie</h3>
    <?php if (empty($questions)): ?>
        <div class="no-questions-info">
            <p>Ta ankieta nie posiada jeszcze żadnych pytań. Użyj formularza powyżej, aby dodać pierwsze pytanie.</p>
        </div>
    <?php else: ?>
    <?php foreach($questions as $q): ?>
        <form action="/updateQuestion" method="POST" class="edit-question-card">
            <input type="hidden" name="question_id" value="<?= $q['id'] ?>">
            <input type="hidden" name="survey_id" value="<?= $survey['id'] ?>">

            <div class="edit-text-area">
                <label>Treść pytania:</label>
                <input type="text" name="question_text" value="<?= htmlspecialchars($q['question_text']) ?>" required>
            </div>

            <div class="edit-scores-row"> 
                <div class="score-field">
                    <span>L/P</span>
                    <input type="number" name="lp" min="-5" max="5" value="<?= $q['score_lewa_prawa'] ?>">
                </div>
                <div class="score-field">
                    <span>W/W</span>
                    <input type="number" name="ww" min="-5" max="5" value="<?= $q['score_wladza_wolnosc'] ?>">
                </div>
                <div class="score-field">
                    <span>P/K</span>
                    <input type="number" name="pk" min="-5" max="5" value="<?= $q['score_postep_konserwa'] ?>">
                </div>
                <div class="score-field">
                    <span>G/N</span>
                    <input type="number" name="gn" min="-5" max="5" value="<?= $q['score_globalizm_nacjonalizm'] ?>">
                </div>
                
                <button type="submit" class="btn-save">Zapisz zmiany</button>
                <a href="/deleteQuestion?id=<?= $q['id'] ?>&survey_id=<?= $survey['id'] ?>" 
                   class="btn-delete-small" 
                   onclick="return confirm('Usunąć to pytanie?')">Usuń</a>
            </div>
        </form>
    <?php endforeach; ?>
    <?php endif; ?>
</section>
</div>
</html>
